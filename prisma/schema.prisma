generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgres"
  url      = env("DATABASE_URL")
}

//======//AGENDA//======//

model Contato {
  id         String      @id @default(uuid())
  nome       String
  categorias Categoria[]
  telefone   String      @unique

  criadoEm     DateTime  @default(now()) @map("criado_em")
  atualizadoEm DateTime? @updatedAt @map("atualizado_em")

  usuario Usuario?

  @@map("contato")
}

model Usuario {
  contato Contato @relation(fields: [contatoId], references: [id])

  contatoId String  @id @map("contato_id")
  email     String  @unique
  username  String? @unique
  senha     String
  ativo     Boolean @default(true)

  criadoEm     DateTime  @default(now()) @map("criado_em")
  atualizadoEm DateTime? @updatedAt @map("atualizado_em")

  @@map("usuario")
}

enum Categoria {
  dentista
  fornecedor
  cliente
  colaborador
  entregador
  gerente
  admin

  @@map("categoria")
}

//======//OPERACIONAL//======//

//==estoque==//

model Produto {
  id        String      @id @default(uuid())
  nome      String      @unique
  descricao String?
  tipo      TipoProduto

  historicoValores ValorProduto[]
  itemServicos     ItemServico[]

  @@map("produto")
}

enum TipoProduto {
  pt
  ppr
  pino
  restauracao

  @@map("tipo_produto")
}

model ValorProduto {
  produto Produto @relation(fields: [produtoId], references: [id])

  id        String    @id @default(uuid())
  produtoId String    @map("produto_id")
  espOdont  Boolean   @map("esp_odont")
  dtInicio  DateTime  @default(now()) @map("dt_inicio")
  dtFim     DateTime? @map("dt_fim")

  @@map("valor_produto")
}

//==prestação de serviços==//

model Servico {
  id String @id @default(uuid())

  itensServico ItemServico[]

  @@map("servico")
}

model ItemServico {
  produto Produto @relation(fields: [produtoId], references: [id])
  servico Servico @relation(fields: [servicoId], references: [id])

  produtoId        String          @map("produto_id")
  servicoId        String          @map("servico_id")
  quantidade       Int
  estadoFabricacao EstaoFabricacao @map("estado_fabricacao")

  @@id([produtoId, servicoId])
  @@map("item_servico")
}

enum EstaoFabricacao {
  recebido
  fabricando
  concluido

  @@map("estado_fabricacao")
}

//======//CAIXA//======//
